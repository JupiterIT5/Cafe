{% extends "cafe/block/base.html" %}

{% load static %}

{% block style %}
    <link rel="stylesheet" href="{% static "css/dish.css" %}">
{% endblock %}    
    
{% block title %}
    {{ dish.name }}
{% endblock %}

{% block content %}
    <div class="section__dish">
        {% if dish.photo %}
            <div class="img__dish"><img src="{{ dish.photo.url }}" alt="dish"></div>
        {% endif %}
        <div class="info">
            <h2>{{ dish.name }}</h2>
            <p>{{ dish.description }}</p>
            <h3>{{ dish.price }} ₽</h3> 
            <h3 style="margin-bottom: 10px">Категория: {{ dish.category.name }} - {{ dish.category.description }}</h3>
            <h3 style="margin-bottom: 10px; margin-top: 30px">Теги: <br/></h3>
            {% for tag in dish.tag.all %}
                <h4>{{ tag }} - {% if tag.desctiption %}{{ tag.desctiption }}{% else %}Отсутствует{% endif %}</h4>
            {% endfor %}
            {% if request.user.is_authenticated %}
                <a href="{% url "ordering_dish" %}">Заказать блюдо...</a>
            {% endif %}
        </div>
    </div>
    <div class="about">
        <div class="title">Характеристика</div>
        <p>
            {%  for parameter in dish.posparametr_set.all %}
                {{ parameter.parametr.name }}
            {% endfor %}
        </p>
        <div class="title">Значение</div>
        <p>
            {%  for parameter in dish.posparametr_set.all %}
                {{ parameter.value }}
            {% endfor %}
        </p>
    </div>

    {% if request.user.is_staff %}
        <div class="product_info">
            <div class='title'>Все заказы</div>
            <p>
                {% for order in dish.posorder_set.all %}
                    {{ order.order }} | Кол-во - {{ order.count }}<br/>
                {% endfor %}
            </p>
            <div class='title'>Все поставки</div>
            <p>
                {% for supply in dish.possupply_set.all %}
                    {{ supply.supply }} | Кол-во - {{ supply.count }}<br/>
                {% endfor %}
            </p>
        </div>
    {% endif %}
{% endblock %}